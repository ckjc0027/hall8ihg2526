<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IHG Tournament 25/26</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    // Initialize Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyAhAmcMvvqfws7TFckaNuvOKAutk1b1Fqw",
      authDomain: "ihg-tournament-deb2b.firebaseapp.com",
      projectId: "ihg-tournament-deb2b",
      storageBucket: "ihg-tournament-deb2b.firebasestorage.app",
      messagingSenderId: "756046827612",
      appId: "1:756046827612:web:aac459a04b55e79f3e1699"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Icons
    const Plus = () => (
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <line x1="12" y1="5" x2="12" y2="19"></line>
        <line x1="5" y1="12" x2="19" y2="12"></line>
      </svg>
    );

    const Edit2 = ({size = 16}) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path>
      </svg>
    );

    const Trash2 = ({size = 16}) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <polyline points="3 6 5 6 21 6"></polyline>
        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
      </svg>
    );

    const Save = ({size = 18}) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
        <polyline points="17 21 17 13 7 13 7 21"></polyline>
        <polyline points="7 3 7 8 15 8"></polyline>
      </svg>
    );

    const X = ({size = 18}) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    );

    const Lock = ({size = 18}) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
        <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
      </svg>
    );

    const Unlock = ({size = 18}) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
        <path d="M7 11V7a5 5 0 0 1 9.9-1"></path>
      </svg>
    );

    function App() {
      const [isAdmin, setIsAdmin] = useState(false);
      const [password, setPassword] = useState('');
      const [showLogin, setShowLogin] = useState(false);
      const [isLoading, setIsLoading] = useState(true);
      const [isSaving, setIsSaving] = useState(false);
      
      const [myTeamName, setMyTeamName] = useState('Hall A Warriors');
      const [editingTeamName, setEditingTeamName] = useState(false);
      const [tempTeamName, setTempTeamName] = useState('');
      
      const [sports, setSports] = useState(['Basketball', 'Football', 'Volleyball', 'Badminton']);
      const [newSport, setNewSport] = useState('');
      
      const [matches, setMatches] = useState([]);
      const [finalPlacing, setFinalPlacing] = useState({});
      const [editingMatch, setEditingMatch] = useState(null);
      const [selectedSport, setSelectedSport] = useState('All Sports');

      useEffect(() => {
        loadData();
      }, []);

      useEffect(() => {
        if (!isLoading) {
          saveData();
        }
      }, [myTeamName, sports, matches, finalPlacing]);

      async function loadData() {
        try {
          const doc = await db.collection('tournament').doc('data').get();
          if (doc.exists) {
            const data = doc.data();
            setMyTeamName(data.myTeamName || 'Hall A Warriors');
            setSports(data.sports || ['Basketball', 'Football', 'Volleyball', 'Badminton']);
            setMatches(data.matches || []);
            setFinalPlacing(data.finalPlacing || {});
          }
        } catch (error) {
          console.error('Load error:', error);
        }
        setIsLoading(false);
      }

      async function saveData() {
        setIsSaving(true);
        try {
          await db.collection('tournament').doc('data').set({
            myTeamName,
            sports,
            matches,
            finalPlacing,
            lastUpdated: firebase.firestore.FieldValue.serverTimestamp()
          });
        } catch (error) {
          console.error('Save error:', error);
        }
        setTimeout(() => setIsSaving(false), 500);
      }

      const handleLogin = () => {
        if (password === 'watchmego') {
          setIsAdmin(true);
          setShowLogin(false);
          setPassword('');
        } else {
          alert('Incorrect password');
        }
      };

      const addSport = () => {
        if (newSport && !sports.includes(newSport)) {
          setSports([...sports, newSport]);
          setFinalPlacing({ ...finalPlacing, [newSport]: { placing: 1, totalTeams: 1, inProgress: true } });
          setNewSport('');
        }
      };

      const deleteSport = (sport) => {
        if (window.confirm(`Delete ${sport}?`)) {
          setSports(sports.filter(s => s !== sport));
          setMatches(matches.filter(m => m.sport !== sport));
          const newPlacing = { ...finalPlacing };
          delete newPlacing[sport];
          setFinalPlacing(newPlacing);
        }
      };

      const addMatch = () => {
        const newMatch = {
          id: Date.now(),
          sport: sports[0] || '',
          opponent: '',
          date: new Date().toISOString().split('T')[0],
          time: '12:00',
          score: '',
          result: 'pending'
        };
        setMatches([...matches, newMatch]);
        setEditingMatch(newMatch.id);
      };

      const updateMatch = (id, field, value) => {
        setMatches(matches.map(m => m.id === id ? { ...m, [field]: value } : m));
      };

      const deleteMatch = (id) => {
        setMatches(matches.filter(m => m.id !== id));
      };

      const updatePlacing = (sport, field, value) => {
        setFinalPlacing({
          ...finalPlacing,
          [sport]: {
            ...finalPlacing[sport],
            [field]: field === 'inProgress' ? value : (parseInt(value) || 1)
          }
        });
      };

      const today = new Date().toISOString().split('T')[0];
      const todayMatches = matches.filter(m => m.date >= today).sort((a, b) => new Date(a.date) - new Date(b.date));
      const pastMatches = matches.filter(m => m.date < today).sort((a, b) => new Date(b.date) - new Date(a.date));
      const filteredMatches = selectedSport === 'All Sports' ? pastMatches : pastMatches.filter(m => m.sport === selectedSport);

      if (isLoading) {
        return (
          <div className="min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 text-gray-100 flex items-center justify-center">
            <div className="text-2xl">Loading...</div>
          </div>
        );
      }

      return (
        <div className="min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 text-gray-100 p-6">
          <div className="max-w-7xl mx-auto">
            <div className="flex justify-between items-center mb-8">
              <div className="flex items-center gap-4">
                <h1 className="text-5xl font-bold bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent">IHG 25/26</h1>
                {editingTeamName ? (
                  <div className="flex items-center gap-2">
                    <input type="text" value={tempTeamName} onChange={(e) => setTempTeamName(e.target.value)} className="px-3 py-1 bg-gray-700 border border-gray-600 rounded text-lg text-white" />
                    <button onClick={() => { setMyTeamName(tempTeamName); setEditingTeamName(false); }} className="p-1 hover:bg-gray-700 rounded"><Save size={18} /></button>
                    <button onClick={() => setEditingTeamName(false)} className="p-1 hover:bg-gray-700 rounded"><X size={18} /></button>
                  </div>
                ) : (
                  <div className="flex items-center gap-2">
                    <h2 className="text-2xl text-gray-300">{myTeamName}</h2>
                    {isAdmin && <button onClick={() => { setTempTeamName(myTeamName); setEditingTeamName(true); }} className="p-1 hover:bg-gray-700 rounded"><Edit2 size={16} /></button>}
                  </div>
                )}
              </div>
              <div className="flex items-center gap-3">
                {isSaving && <span className="text-sm text-green-400">âœ“ Saved</span>}
                <button onClick={() => isAdmin ? setIsAdmin(false) : setShowLogin(!showLogin)} className="flex items-center gap-2 px-4 py-2 bg-gray-800 hover:bg-gray-700 rounded-lg border border-gray-600 transition">
                  {isAdmin ? <Unlock size={18} /> : <Lock size={18} />}
                  {isAdmin ? 'Admin Mode' : 'Login'}
                </button>
              </div>
            </div>

            {showLogin && !isAdmin && (
              <div className="mb-6 p-4 bg-gray-800 border border-gray-700 rounded-lg">
                <div className="flex gap-2">
                  <input type="password" value={password} onChange={(e) => setPassword(e.target.value)} onKeyPress={(e) => e.key === 'Enter' && handleLogin()} placeholder="Enter admin password" className="flex-1 px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white" />
                  <button onClick={handleLogin} className="px-6 py-2 bg-blue-600 hover:bg-blue-500 rounded-lg transition">Login</button>
                </div>
              </div>
            )}

            {isAdmin && (
              <div className="mb-8 p-6 bg-gray-800 border border-gray-700 rounded-lg">
                <h3 className="text-xl font-semibold mb-4 text-blue-400">Manage Sports</h3>
                <div className="flex flex-wrap gap-2 mb-4">
                  {sports.map(sport => (
                    <div key={sport} className="flex items-center gap-2 px-3 py-2 bg-gray-700 rounded-lg">
                      <span>{sport}</span>
                      <button onClick={() => deleteSport(sport)} className="text-red-400 hover:text-red-300"><Trash2 size={16} /></button>
                    </div>
                  ))}
                </div>
                <div className="flex gap-2">
                  <input type="text" value={newSport} onChange={(e) => setNewSport(e.target.value)} placeholder="Add new sport" className="flex-1 px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white" />
                  <button onClick={addSport} className="px-4 py-2 bg-green-600 hover:bg-green-500 rounded-lg flex items-center gap-2 transition"><Plus />Add Sport</button>
                </div>
              </div>
            )}

            <div className="mb-8 p-6 bg-gradient-to-br from-blue-900/30 to-purple-900/30 border border-blue-500/30 rounded-lg">
              <div className="flex justify-between items-center mb-4">
                <h3 className="text-2xl font-semibold text-blue-300">Upcoming Matches</h3>
                {isAdmin && <button onClick={addMatch} className="px-4 py-2 bg-blue-600 hover:bg-blue-500 rounded-lg flex items-center gap-2 transition"><Plus />Add Match</button>}
              </div>
              {todayMatches.length === 0 ? (
                <p className="text-gray-400 text-center py-4">No upcoming matches</p>
              ) : (
                <div className="space-y-3">
                  {todayMatches.map(match => (
                    <div key={match.id} className="p-4 bg-gray-800/50 rounded-lg border border-gray-700">
                      {editingMatch === match.id && isAdmin ? (
                        <div className="space-y-2">
                          <select value={match.sport} onChange={(e) => updateMatch(match.id, 'sport', e.target.value)} className="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white">
                            {sports.map(s => <option key={s} value={s}>{s}</option>)}
                          </select>
                          <input type="text" value={match.opponent} onChange={(e) => updateMatch(match.id, 'opponent', e.target.value)} placeholder="Opponent" className="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white" />
                          <input type="date" value={match.date} onChange={(e) => updateMatch(match.id, 'date', e.target.value)} className="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white" />
                          <input type="time" value={match.time} onChange={(e) => updateMatch(match.id, 'time', e.target.value)} className="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white" />
                          <input type="text" value={match.score} onChange={(e) => updateMatch(match.id, 'score', e.target.value)} placeholder="Score" className="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white" />
                          <select value={match.result} onChange={(e) => updateMatch(match.id, 'result', e.target.value)} className="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white">
                            <option value="pending">Pending</option>
                            <option value="win">Win</option>
                            <option value="loss">Loss</option>
                            <option value="draw">Draw</option>
                          </select>
                          <div className="flex gap-2">
                            <button onClick={() => setEditingMatch(null)} className="flex-1 px-4 py-2 bg-green-600 hover:bg-green-500 rounded transition">Save</button>
                            <button onClick={() => deleteMatch(match.id)} className="px-4 py-2 bg-red-600 hover:bg-red-500 rounded transition">Delete</button>
                          </div>
                        </div>
                      ) : (
                        <div className="flex justify-between items-center">
                          <div>
                            <div className="text-sm text-blue-400 font-semibold">{match.sport}</div>
                            <div className="text-lg">{myTeamName} vs {match.opponent}</div>
                            <div className="text-sm text-gray-400">{match.time} â€¢ {match.score || 'TBD'}</div>
                          </div>
                          <div className="flex items-center gap-3">
                            <span className={`px-3 py-1 rounded-full text-sm font-semibold ${match.result === 'win' ? 'bg-green-500/20 text-green-400' : match.result === 'loss' ? 'bg-red-500/20 text-red-400' : match.result === 'draw' ? 'bg-yellow-500/20 text-yellow-400' : 'bg-gray-500/20 text-gray-400'}`}>
                              {match.result.toUpperCase()}
                            </span>
                            {isAdmin && <button onClick={() => setEditingMatch(match.id)} className="p-2 hover:bg-gray-700 rounded transition"><Edit2 size={16} /></button>}
                          </div>
                        </div>
                      )}
                    </div>
                  ))}
                </div>
              )}
            </div>

            <div className="mb-8 p-6 bg-gray-800 border border-gray-700 rounded-lg">
              <div className="flex justify-between items-center mb-4">
                <h3 className="text-2xl font-semibold text-purple-300">Match History</h3>
                <select value={selectedSport} onChange={(e) => setSelectedSport(e.target.value)} className="px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white">
                  <option value="All Sports">All Sports</option>
                  {sports.map(s => <option key={s} value={s}>{s}</option>)}
                </select>
              </div>
              {filteredMatches.length === 0 ? (
                <p className="text-gray-400 text-center py-4">No past matches</p>
              ) : (
                <div className="space-y-3">
                  {filteredMatches.map(match => (
                    <div key={match.id} className="p-4 bg-gray-700/50 rounded-lg">
                      {editingMatch === match.id && isAdmin ? (
                        <div className="space-y-2">
                          <select value={match.sport} onChange={(e) => updateMatch(match.id, 'sport', e.target.value)} className="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white">
                            {sports.map(s => <option key={s} value={s}>{s}</option>)}
                          </select>
                          <input type="text" value={match.opponent} onChange={(e) => updateMatch(match.id, 'opponent', e.target.value)} placeholder="Opponent" className="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white" />
                          <input type="date" value={match.date} onChange={(e) => updateMatch(match.id, 'date', e.target.value)} className="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white" />
                          <input type="time" value={match.time} onChange={(e) => updateMatch(match.id, 'time', e.target.value)} className="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white" />
                          <input type="text" value={match.score} onChange={(e) => updateMatch(match.id, 'score', e.target.value)} placeholder="Score" className="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white" />
                          <select value={match.result} onChange={(e) => updateMatch(match.id, 'result', e.target.value)} className="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white">
                            <option value="pending">Pending</option>
                            <option value="win">Win</option>
                            <option value="loss">Loss</option>
                            <option value="draw">Draw</option>
                          </select>
                          <div className="flex gap-2">
                            <button onClick={() => setEditingMatch(null)} className="flex-1 px-4 py-2 bg-green-600 hover:bg-green-500 rounded transition">Save</button>
                            <button onClick={() => deleteMatch(match.id)} className="px-4 py-2 bg-red-600 hover:bg-red-500 rounded transition">Delete</button>
                          </div>
                        </div>
                      ) : (
                        <div className="flex justify-between items-center">
                          <div className="flex-1">
                            <div className="text-sm text-purple-400 font-semibold">{match.sport}</div>
                            <div className="text-lg">{myTeamName} vs {match.opponent}</div>
                            <div className="text-sm text-gray-400">{match.date} â€¢ {match.time} â€¢ {match.score}</div>
                          </div>
                          <div className="flex items-center gap-2">
                            <span className={`px-3 py-1 rounded-full text-sm font-semibold ${match.result === 'win' ? 'bg-green-500/20 text-green-400' : match.result === 'loss' ? 'bg-red-500/20 text-red-400' : match.result === 'draw' ? 'bg-yellow-500/20 text-yellow-400' : 'bg-gray-500/20 text-gray-400'}`}>
                              {match.result.toUpperCase()}
                            </span>
                            {isAdmin && (
                              <div className="flex gap-1">
                                <button onClick={() => setEditingMatch(match.id)} className="p-2 hover:bg-gray-600 rounded transition" title="Edit"><Edit2 size={16} /></button>
                                <button onClick={() => deleteMatch(match.id)} className="p-2 hover:bg-red-900/50 rounded transition text-red-400" title="Delete"><Trash2 size={16} /></button>
                              </div>
                            )}
                          </div>
                        </div>
                      )}
                    </div>
                  ))}
                </div>
              )}
            </div>

            <div className="p-6 bg-gray-800 border border-gray-700 rounded-lg">
              <h3 className="text-2xl font-semibold mb-4 text-green-300">Final Placing</h3>
              <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                {sports.map(sport => {
                  const placing = finalPlacing[sport] || { placing: 1, totalTeams: 1, inProgress: true };
                  const suffix = placing.placing === 1 ? 'st' : placing.placing === 2 ? 'nd' : placing.placing === 3 ? 'rd' : 'th';
                  return (
                    <div key={sport} className="p-4 bg-gray-700 rounded-lg border border-gray-600">
                      <h4 className="text-lg font-semibold text-gray-300 mb-3">{sport}</h4>
                      {isAdmin ? (
                        <div className="space-y-2">
                          <label className="flex items-center gap-2 mb-3">
                            <input type="checkbox" checked={placing.inProgress} onChange={(e) => updatePlacing(sport, 'inProgress', e.target.checked)} className="w-4 h-4" />
                            <span className="text-sm text-gray-300">In Progress</span>
                          </label>
                          {!placing.inProgress && (
                            <>
                              <div>
                                <label className="text-sm text-gray-400 block mb-1">Placing</label>
                                <input type="number" min="1" value={placing.placing} onChange={(e) => updatePlacing(sport, 'placing', e.target.value)} className="w-full px-3 py-2 bg-gray-600 border border-gray-500 rounded text-white" />
                              </div>
                              <div>
                                <label className="text-sm text-gray-400 block mb-1">Total Teams</label>
                                <input type="number" min="1" value={placing.totalTeams} onChange={(e) => updatePlacing(sport, 'totalTeams', e.target.value)} className="w-full px-3 py-2 bg-gray-600 border border-gray-500 rounded text-white" />
                              </div>
                            </>
                          )}
                        </div>
                      ) : (
                        <div className="text-center py-4">
                          {placing.inProgress ? (
                            <div>
                              <div className="text-2xl font-bold text-yellow-400 mb-2">In Progress</div>
                              <div className="text-sm text-gray-400">Tournament ongoing</div>
                            </div>
                          ) : (
                            <div>
                              <div className="text-4xl font-bold text-green-400 mb-2">{placing.placing}{suffix}</div>
                              <div className="text-sm text-gray-400">out of {placing.totalTeams} teams</div>
                            </div>
                          )}
                        </div>
                      )}
                    </div>
                  );
                })}
              </div>
            </div>

            <div className="mt-6 text-center text-sm text-gray-500">ðŸ”¥ Powered by Firebase</div>
          </div>
        </div>
      );
    }

    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>
